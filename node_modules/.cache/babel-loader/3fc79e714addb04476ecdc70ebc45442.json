{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\91799\\\\Desktop\\\\bomb-dashboard-final-task\\\\src\\\\views\\\\Dashboard\\\\Bond.tsx\";\nimport React, { useCallback, useMemo } from 'react';\nimport { createGlobalStyle } from 'styled-components';\nimport { useRouteMatch } from 'react-router-dom';\nimport ExchangeCard from './componentsBond/ExchangeCard';\nimport styled from 'styled-components';\nimport useBondStats from '../../hooks/useBondStats'; //import useBombStats from '../../hooks/useBombStats';\n\nimport useBombFinance from '../../hooks/useBombFinance';\nimport useCashPriceInLastTWAP from '../../hooks/useCashPriceInLastTWAP';\nimport { useTransactionAdder } from '../../state/transactions/hooks';\nimport ExchangeStat from './componentsBond/ExchangeStat';\nimport useTokenBalance from '../../hooks/useTokenBalance';\nimport useBondsPurchasable from '../../hooks/useBondsPurchasable';\nimport { getDisplayBalance } from '../../utils/formatBalance';\nimport { BOND_REDEEM_PRICE, BOND_REDEEM_PRICE_BN } from '../../bomb-finance/constants';\nimport HomeImage from '../../assets/img/background.jpg';\nimport ExchangeCardBtn from './componentsBond/ExchangeCardBtn';\nconst BackgroundImage = createGlobalStyle`\n  body {\n    background: url(${HomeImage}) repeat !important;\n    background-size: cover !important;\n    background-color: #171923;\n  }\n`;\nconst TITLE = 'bomb.money | Bonds';\n\nconst Bond = () => {\n  const {\n    path\n  } = useRouteMatch();\n  const bombFinance = useBombFinance();\n  const addTransaction = useTransactionAdder();\n  const bondStat = useBondStats(); //const bombStat = useBombStats();\n\n  const cashPrice = useCashPriceInLastTWAP();\n  const bondsPurchasable = useBondsPurchasable();\n  const bondBalance = useTokenBalance(bombFinance === null || bombFinance === void 0 ? void 0 : bombFinance.BBOND); //const scalingFactor = useMemo(() => (cashPrice ? Number(cashPrice) : null), [cashPrice]);\n\n  const handleBuyBonds = useCallback(async amount => {\n    const tx = await bombFinance.buyBonds(amount);\n    addTransaction(tx, {\n      summary: `Buy ${Number(amount).toFixed(2)} BBOND with ${amount} BOMB`\n    });\n  }, [bombFinance, addTransaction]);\n  const handleRedeemBonds = useCallback(async amount => {\n    const tx = await bombFinance.redeemBonds(amount);\n    addTransaction(tx, {\n      summary: `Redeem ${amount} BBOND`\n    });\n  }, [bombFinance, addTransaction]);\n  const isBondRedeemable = useMemo(() => cashPrice.gt(BOND_REDEEM_PRICE_BN), [cashPrice]);\n  const isBondPurchasable = useMemo(() => Number(bondStat === null || bondStat === void 0 ? void 0 : bondStat.tokenInFtm) < 1.01, [bondStat]);\n  const isBondPayingPremium = useMemo(() => Number(bondStat === null || bondStat === void 0 ? void 0 : bondStat.tokenInFtm) >= 1.1, [bondStat]); // console.log(\"bondstat\", Number(bondStat?.tokenInFtm))\n\n  const bondScale = (Number(cashPrice) / 100000000000000).toFixed(4);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row p-0 m-0 d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-3 p-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-start m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 40\n    }\n  }, \"Current Price: (Bomb)^2\"), /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"text-start m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 17\n    }\n  }, \"BBond =\", /*#__PURE__*/React.createElement(ExchangeStat, {\n    tokenName: \"10,000 BBOND\",\n    description: \"Current Price: (BOMB)^2\",\n    price: Number(bondStat === null || bondStat === void 0 ? void 0 : bondStat.tokenInFtm).toFixed(4) || '-',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-2 p-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-center m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 40\n    }\n  }, \"Available to Purchase:\"), /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"text-center m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(ExchangeCard, {\n    action: \"Purchase\",\n    fromToken: bombFinance.BOMB,\n    fromTokenName: \"BOMB\",\n    toToken: bombFinance.BBOND,\n    toTokenName: \"BBOND\",\n    priceDesc: !isBondPurchasable ? 'BOMB is over peg' : getDisplayBalance(bondsPurchasable, 18, 4) + ' BBOND',\n    onExchange: handleBuyBonds,\n    disabled: !bondStat || isBondRedeemable,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-2 p-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-center m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 40\n    }\n  }, \"Available to Redeem:\"), /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"text-center m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(ExchangeCard, {\n    action: \"Redeem\",\n    fromToken: bombFinance.BBOND,\n    fromTokenName: \"BBOND\",\n    toToken: bombFinance.BOMB,\n    toTokenName: \"BOMB\",\n    priceDesc: `${getDisplayBalance(bondBalance)} BBOND`,\n    onExchange: handleRedeemBonds,\n    disabled: !bondStat || bondBalance.eq(0) || !isBondRedeemable,\n    disabledDescription: !isBondRedeemable ? `Enabled when 10,000 BOMB > ${BOND_REDEEM_PRICE} BTC` : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-5 p-0 d-flex align-items-center justify-content-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row m-0 p-0 w-75\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"col-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, \"Purchase BBond:\", /*#__PURE__*/React.createElement(ExchangeCardBtn, {\n    className: \"float\",\n    action: \"Purchase\",\n    fromToken: bombFinance.BOMB,\n    fromTokenName: \"BOMB\",\n    toToken: bombFinance.BBOND,\n    toTokenName: \"BBOND\",\n    priceDesc: !isBondPurchasable ? 'BOMB is over peg' : getDisplayBalance(bondsPurchasable, 18, 4) + ' BBOND',\n    onExchange: handleBuyBonds,\n    disabled: !bondStat || isBondRedeemable,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"col-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }, \"Redeem Bomb:\", /*#__PURE__*/React.createElement(ExchangeCardBtn, {\n    action: \"Redeem\",\n    fromToken: bombFinance.BBOND,\n    fromTokenName: \"BBOND\",\n    toToken: bombFinance.BOMB,\n    toTokenName: \"BOMB\",\n    priceDesc: `${getDisplayBalance(bondBalance)} BBOND`,\n    onExchange: handleRedeemBonds,\n    disabled: !bondStat || bondBalance.eq(0) || !isBondRedeemable,\n    disabledDescription: !isBondRedeemable ? `Redeem` : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 25\n    }\n  }))))));\n};\n\nconst StyledBond = styled.div`\n  display: flex;\n  @media (max-width: 768px) {\n    width: 100%;\n    flex-flow: column nowrap;\n    align-items: center;\n  }\n`;\nconst StyledCardWrapper = styled.div`\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  @media (max-width: 768px) {\n    width: 80%;\n  }\n`;\nconst StyledStatsWrapper = styled.div`\n  display: flex;\n  flex: 0.8;\n  margin: 0 20px;\n  flex-direction: column;\n\n  @media (max-width: 768px) {\n    width: 80%;\n    margin: 16px 0;\n  }\n`;\nexport default Bond;","map":{"version":3,"sources":["C:/Users/91799/Desktop/bomb-dashboard-final-task/src/views/Dashboard/Bond.tsx"],"names":["React","useCallback","useMemo","createGlobalStyle","useRouteMatch","ExchangeCard","styled","useBondStats","useBombFinance","useCashPriceInLastTWAP","useTransactionAdder","ExchangeStat","useTokenBalance","useBondsPurchasable","getDisplayBalance","BOND_REDEEM_PRICE","BOND_REDEEM_PRICE_BN","HomeImage","ExchangeCardBtn","BackgroundImage","TITLE","Bond","path","bombFinance","addTransaction","bondStat","cashPrice","bondsPurchasable","bondBalance","BBOND","handleBuyBonds","amount","tx","buyBonds","summary","Number","toFixed","handleRedeemBonds","redeemBonds","isBondRedeemable","gt","isBondPurchasable","tokenInFtm","isBondPayingPremium","bondScale","BOMB","eq","StyledBond","div","StyledCardWrapper","StyledStatsWrapper"],"mappings":"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","sourcesContent":["import React, {useCallback, useMemo} from 'react';\r\nimport Page from '../../components/Page';\r\nimport {createGlobalStyle} from 'styled-components';\r\nimport {Route, Switch, useRouteMatch} from 'react-router-dom';\r\nimport PageHeader from '../../components/PageHeader';\r\nimport ExchangeCard from './componentsBond/ExchangeCard';\r\nimport styled from 'styled-components';\r\nimport Spacer from '../../components/Spacer';\r\nimport useBondStats from '../../hooks/useBondStats';\r\n//import useBombStats from '../../hooks/useBombStats';\r\nimport useBombFinance from '../../hooks/useBombFinance';\r\nimport useCashPriceInLastTWAP from '../../hooks/useCashPriceInLastTWAP';\r\nimport {useTransactionAdder} from '../../state/transactions/hooks';\r\nimport ExchangeStat from './componentsBond/ExchangeStat';\r\nimport useTokenBalance from '../../hooks/useTokenBalance';\r\nimport useBondsPurchasable from '../../hooks/useBondsPurchasable';\r\nimport {getDisplayBalance} from '../../utils/formatBalance';\r\nimport { BOND_REDEEM_PRICE, BOND_REDEEM_PRICE_BN } from '../../bomb-finance/constants';\r\nimport { Alert } from '@material-ui/lab';\r\n\r\n\r\nimport HomeImage from '../../assets/img/background.jpg';\r\nimport { Grid, Box } from '@material-ui/core';\r\nimport { Helmet } from 'react-helmet';\r\nimport ExchangeCardBtn from './componentsBond/ExchangeCardBtn';\r\n\r\nconst BackgroundImage = createGlobalStyle`\r\n  body {\r\n    background: url(${HomeImage}) repeat !important;\r\n    background-size: cover !important;\r\n    background-color: #171923;\r\n  }\r\n`;\r\nconst TITLE = 'bomb.money | Bonds'\r\n\r\nconst Bond: React.FC = () => {\r\n  const {path} = useRouteMatch();\r\n  const bombFinance = useBombFinance();\r\n  const addTransaction = useTransactionAdder();\r\n  const bondStat = useBondStats();\r\n  //const bombStat = useBombStats();\r\n  const cashPrice = useCashPriceInLastTWAP();\r\n\r\n  const bondsPurchasable = useBondsPurchasable();\r\n\r\n  const bondBalance = useTokenBalance(bombFinance?.BBOND);\r\n  //const scalingFactor = useMemo(() => (cashPrice ? Number(cashPrice) : null), [cashPrice]);\r\n\r\n  const handleBuyBonds = useCallback(\r\n    async (amount: string) => {\r\n      const tx = await bombFinance.buyBonds(amount);\r\n      addTransaction(tx, {\r\n        summary: `Buy ${Number(amount).toFixed(2)} BBOND with ${amount} BOMB`,\r\n      });\r\n    },\r\n    [bombFinance, addTransaction],\r\n  );\r\n\r\n  const handleRedeemBonds = useCallback(\r\n    async (amount: string) => {\r\n      const tx = await bombFinance.redeemBonds(amount);\r\n      addTransaction(tx, {summary: `Redeem ${amount} BBOND`});\r\n    },\r\n    [bombFinance, addTransaction],\r\n  );\r\n  const isBondRedeemable = useMemo(() => cashPrice.gt(BOND_REDEEM_PRICE_BN), [cashPrice]);\r\n  const isBondPurchasable = useMemo(() => Number(bondStat?.tokenInFtm) < 1.01, [bondStat]);\r\n  const isBondPayingPremium = useMemo(() => Number(bondStat?.tokenInFtm) >= 1.1, [bondStat]);\r\n// console.log(\"bondstat\", Number(bondStat?.tokenInFtm))\r\n  const bondScale = (Number(cashPrice) / 100000000000000).toFixed(4); \r\n\r\n  return (\r\n    <>\r\n        <div className='row p-0 m-0 d-flex justify-content-between'>\r\n            <div className='col-3 p-0'><p className='text-start m-0'>Current Price: (Bomb)^2</p>\r\n                <h5 className='text-start m-0'>BBond = \r\n                    <ExchangeStat\r\n                        tokenName=\"10,000 BBOND\"\r\n                        description=\"Current Price: (BOMB)^2\"\r\n                        price={Number(bondStat?.tokenInFtm).toFixed(4) || '-'}\r\n                    /> \r\n                </h5>\r\n            </div>\r\n            <div className='col-2 p-0'><p className='text-center m-0'>Available to Purchase:</p>\r\n                <h5 className='text-center m-0'>\r\n                    <ExchangeCard\r\n                        action=\"Purchase\"\r\n                        fromToken={bombFinance.BOMB}\r\n                        fromTokenName=\"BOMB\"\r\n                        toToken={bombFinance.BBOND}\r\n                        toTokenName=\"BBOND\"\r\n                        priceDesc={\r\n                        !isBondPurchasable\r\n                            ? 'BOMB is over peg'\r\n                            : getDisplayBalance(bondsPurchasable, 18, 4) + ' BBOND'\r\n                        }\r\n                        onExchange={handleBuyBonds}\r\n                        disabled={!bondStat || isBondRedeemable}\r\n                    />\r\n                </h5>\r\n            </div>\r\n            <div className='col-2 p-0'><p className='text-center m-0'>Available to Redeem:</p>\r\n                <h5 className='text-center m-0'>\r\n                    <ExchangeCard\r\n                        action=\"Redeem\"\r\n                        fromToken={bombFinance.BBOND}\r\n                        fromTokenName=\"BBOND\"\r\n                        toToken={bombFinance.BOMB}\r\n                        toTokenName=\"BOMB\"\r\n                        priceDesc={`${getDisplayBalance(bondBalance)} BBOND`}\r\n                        onExchange={handleRedeemBonds}\r\n                        disabled={!bondStat || bondBalance.eq(0) || !isBondRedeemable}\r\n                        disabledDescription={!isBondRedeemable ? `Enabled when 10,000 BOMB > ${BOND_REDEEM_PRICE} BTC` : null}\r\n                    />\r\n                </h5>\r\n            </div>\r\n            <div className='col-5 p-0 d-flex align-items-center justify-content-end'>\r\n                <div className='row m-0 p-0 w-75'>\r\n                    <span className='col-12'>Purchase BBond: \r\n                        <ExchangeCardBtn\r\n                            className='float'\r\n                            action=\"Purchase\"\r\n                            fromToken={bombFinance.BOMB}\r\n                            fromTokenName=\"BOMB\"\r\n                            toToken={bombFinance.BBOND}\r\n                            toTokenName=\"BBOND\"\r\n                            priceDesc={!isBondPurchasable ? 'BOMB is over peg' : getDisplayBalance(bondsPurchasable, 18, 4) + ' BBOND'}\r\n                            onExchange={handleBuyBonds}\r\n                            disabled={!bondStat || isBondRedeemable}\r\n                        />\r\n                    </span>\r\n                    <span className='col-12'>Redeem Bomb: \r\n                        <ExchangeCardBtn\r\n                            action=\"Redeem\"\r\n                            fromToken={bombFinance.BBOND}\r\n                            fromTokenName=\"BBOND\"\r\n                            toToken={bombFinance.BOMB}\r\n                            toTokenName=\"BOMB\"\r\n                            priceDesc={`${getDisplayBalance(bondBalance)} BBOND`}\r\n                            onExchange={handleRedeemBonds}\r\n                            disabled={!bondStat || bondBalance.eq(0) || !isBondRedeemable}\r\n                            disabledDescription={!isBondRedeemable ? `Redeem` : null}\r\n                        />   \r\n                    </span>\r\n                </div>\r\n            </div>\r\n        </div>  \r\n    </>\r\n  );\r\n};\r\n\r\nconst StyledBond = styled.div`\r\n  display: flex;\r\n  @media (max-width: 768px) {\r\n    width: 100%;\r\n    flex-flow: column nowrap;\r\n    align-items: center;\r\n  }\r\n`;\r\n\r\nconst StyledCardWrapper = styled.div`\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n  @media (max-width: 768px) {\r\n    width: 80%;\r\n  }\r\n`;\r\n\r\nconst StyledStatsWrapper = styled.div`\r\n  display: flex;\r\n  flex: 0.8;\r\n  margin: 0 20px;\r\n  flex-direction: column;\r\n\r\n  @media (max-width: 768px) {\r\n    width: 80%;\r\n    margin: 16px 0;\r\n  }\r\n`;\r\n\r\nexport default Bond;\r\n"]},"metadata":{},"sourceType":"module"}